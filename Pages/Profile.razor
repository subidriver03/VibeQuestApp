@page "/profile"
@using VibeQuestApp.Data
@using VibeQuestApp.Models
@using Microsoft.EntityFrameworkCore
@inject AppDbContext Db

<h3>Welcome, @hero?.HeroName!</h3>

@if (hero == null)
{
    <p>Loading your profile...</p>
}
else
{
    <div class="card p-3" style="max-width: 900px;">
        <div class="d-flex align-items-start gap-4">
            @if (!string.IsNullOrWhiteSpace(hero.AvatarUrl))
            {
                <img src="@hero.AvatarUrl"
                     alt="Your Avatar"
                     class="rounded"
                     style="transform: scale(0.5); transform-origin: top left;" />
            }

            <div>
                <p><strong>Email:</strong> @user?.Email</p>
                <p><strong>Hero Name:</strong> @hero.HeroName</p>
                <p><strong>Level:</strong> @hero.Level</p>
                <p><strong>Current XP:</strong> @hero.CurrentXP</p>
                <p><strong>Total XP:</strong> @hero.TotalXP</p>
                <p><strong>Life Focus Areas:</strong> @hero.LifeFocusAreas</p>
                <p><strong>Primary Goals:</strong> @hero.PrimaryGoals</p>
                <p><strong>Long-Term Vision:</strong> @hero.LongTermVision</p>
                <p><strong>Motivation Style:</strong> @hero.MotivationStyle</p>
                <p><strong>Commitment Level:</strong> @hero.CommitmentLevel</p>
                <p><strong>Daily Reset Time:</strong> @hero.DailyResetTime</p>
            </div>
        </div>
    </div>
}

@code {
    private int currentUserId = 1; // TEMP: replace with real user login ID
    private HeroProfile? hero;
    private User? user;

    protected override async Task OnInitializedAsync()
    {
        hero = await Db.HeroProfiles.FirstOrDefaultAsync(h => h.UserId == currentUserId);
        user = await Db.Users.FirstOrDefaultAsync(u => u.Id == currentUserId);
    }
}
